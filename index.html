<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Bookmarklets - lasercar/marklets</title>

  <style>

    body {
      font-family: sans-serif;
      text-align: center;
    }

    .marklets {
      text-align: right;
      /* TODO: center div with contents right-aligned and flexible width */
    }

    ul {
      list-style: none;
    }

  </style>
</head>
<body>

  <div class="header"><h1>Bookmarklets</h1>
    <h2><a href="https://github.com/lasercar/marklets">lasercar/marklets</a></h2>
  </div>

  <hr>

  <div class="marklets">
    <ul id="marklets"></ul>
  </div>

  <hr>

  <div class="footer">
    <p>footer</p>
  </div>

<!-- script -->
  <script>

    var elements = {
      marklets: document.querySelector("#marklets")
    };

    var templates = {
      Seperator: function() {
        var seperatorElm = document.createElement("span");
        seperatorElm.innerHTML = " - ";
        return seperatorElm;
      },
      MarkletMeta: function(info) {
        var metaElm = document.createElement("span"); //extends element.span
        metaElm.innerHTML = info; //SECURITY flaw (xss)
        return metaElm;
      },
      Marklet: function Marklet(name, url) {
        var markletElm = document.createElement("a"); //extends element.a
        markletElm.innerHTML = name; //SECURITY flaw (xss)
        markletElm.href = url;
        return markletElm;
      },
      MarkletContainer: function Container(data) {
        var containerElm = document.createElement("li"); //extends element.li
        var markletElm = new templates.Marklet(data.name, data.url);
        var seperatorElm = new templates.Seperator();
        if (data.info) {
          var metaElm = new templates.MarkletMeta(data.info);
          containerElm.appendChild(metaElm);
          containerElm.appendChild(seperatorElm)
        }
        containerElm.appendChild(markletElm);
        return containerElm;
      }
    };

    function renderMarklets(dataset) { //data = [{name,url,?info},...]
      dataset.forEach(function(data) {
        var container = new templates.MarkletContainer(data);
        elements.marklets.appendChild(container);
      });
    }

    //TEST
    fakeDataset = [
      {name:"google", url:"https://google.com"},
      {name:"youtube", url:"https://youtube.com", info:"this is still google"}
    ];
    renderMarklets(fakeDataset);

  </script>
</body>
</html>
